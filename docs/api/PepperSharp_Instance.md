# Instance Class Reference

## Description

An instance is a rectangle on a web page that is managed by a PepperPlugin module.

  * An instance may have a dimension of width=0 and height=0, meaning that the instance does not have any visible component on the web page.
  * An instance is created by including an `<embed></embed>` element in a web page. 
    * The `<embed></embed>` element references a Dot Net class that implements the PepperSharp API and loads the appropriate version of the PepperPlugin module. 
    * A PepperPlugin module may be included in a web page multiple times by using multiple `<embed></embed>` elements that refer to the class implementation; in this case the Native Client runtime system loads the module once and creates multiple instances that are managed by the module.

## Constructors

| Name | Description |
| ---- | ----------- |
| Instance () | Not implemented - Throws error if called |
| Instance(IntPtr handle) | Creates an object instance of Instance using the handle passed.  The handle is a pointer passed to the class when instantiated by the PepperPlugin Native Client implementation. |

## Properties
| Name | Description |
| ---- | ----------- |
| IsFullFrame | Getter that determines if the instance is full-frame (repr).</br></br>Such an instance represents the entire document in a frame rather than an embedded resource.  This can happen if the user does a top-level navigation or the page specifies an iframe to a resource with a MIME type registered by the module. |
| IsFullScreen | Getter and Setter that checks whether the module instance is currently in fullscreen mode or sets the instance to full screen mode.</br></br>The setter switches the module instance to and from fullscreen mode.</br></br>The transition to and from fullscreen mode is asynchronous. During the transition, IsFullscreen will return the previous value and no 2D or 3D device can be bound. The transition ends at DidChangeView() when IsFullscreen() returns the new value. You might receive other DidChangeView() calls while in transition.</br></br>The transition to fullscreen mode can only occur while the browser is processing a user gesture, even if <code>true</code> is returned.</br></br>**Remarks**: Throws InvalidOperationException if there was an error transitioning to or from fullscreen mode. |
| ScreenSize | Gets the size of the screen in pixels. The module instance will be resized to this size when IsFullscreen is set to true to enter fullscreen mode.</br></br>**Remarks**: Throws InvalidOperationException if there was an error obtaining the screen size for some reason.
            
## Methods

| Name          | Description |
| :------------- | ----------- |
| OnInitialize(InitializeEventArgs) | Raise event to intialize the instance with the provided arguments. This event will be raised immediately after the instance object is constructed.</br></br>**Remarks**: The OnInitialize method also enables derived classes to handle the event without attaching a delegate. This is the preferred technique for handling the event in a derived class. | 
| OnViewChanged(PepperSharp.View) | Raises the ViewChange event when the view information for the Instance has changed. See the <code>View</code> object for information.</br></br>Most implementations will want to check if the size and user visibility changed, and either resize themselves or start/stop generating updates.</br></br>**Remarks**: The OnViewChanged method also enables derived classes to handle the event without attaching a delegate. This is the preferred technique for handling the event in a derived class.
| OnFocusChanged(System.Boolean) | Raises the FocusChanged event when an instance has gained or lost focus.</br></br>Having focus means that keyboard events will be sent to the instance.  An instance's default condition is that it will not have focus.</br></br>The focus flag takes into account both browser tab and window focus as well as focus of the plugin element on the page. In order to be deemed to have focus, the browser window must be topmost, the tab must be selected in the window, and the instance must be the focused element on the page.</br><br>**Note**: Clicks on instances will give focus only if you handle the click event. Return true from HandleInputEvent in InputEvent (or use unfiltered events) to signal that the click event was handled. Otherwise, the browser will bubble the event and give focus to the element on the page that actually did end up consuming it.If you're not getting focus, check to make sure yo're either requesting them via RequestInputEvents() (which implicitly marks all input events as consumed) or via RequestFilteringInputEvents() and returning true from your event handler.</br></br>**Remarks**:              The OnFocusChanged method also enables derived classes to handle the event without attaching a delegate. This is the preferred technique for handling the event in a derived class. |
| OnInputEvents(PepperSharp.InputEvent) | Raises the HandleInput event from the browser.</br></br>The default implementation does nothing and returns false.</br<</br>In order to receive input events, you must register for them by calling RequestInputEvents() or RequestFilteringInputEvents(). By default, no events are delivered.</br></br>If the event was handled, it will not be forwarded to any default handlers.If it was not handled, it may be dispatched to a default handler.So it is important that an instance respond accurately with whether event propagation should continue.</br></br>Event propagation also controls focus.If you handle an event like a mouse event, typically the instance will be given focus. Returning false from a filtered event handler or not registering for an event type means that the click will be given to a lower part of the page and your instance  will not receive focus.This allows an instance to be partially transparent, where clicks on the transparent areas will behave like clicks to the underlying page.</br></br>In general, you should try to keep input event handling short. Especially for filtered input events, the browser or page may be blocked waiting for you to respond.</br></br>The caller of this function will maintain a reference to the input event resource during this call.  Unless you take a reference to the resource to hold it for later, you don't need to release it.</br></br>**Note**: If you're not receiving input events, make sure you register for the event classes you want by calling RequestInputEvents or RequestFilteringInputEvents. If you're still not receiving keyboard input events, make sure you're returning true (or using a non-filtered event handler) for mouse events. Otherwise, the instance will not receive focus and keyboard events will not be sent.</br></br>Refer to RequestInputEvents and RequestFilteringInputEvents for further information.</br></br>**Remarks**: The OnInputEvents method also enables derived classes to handle the event without attaching a delegate. This is the preferred technique for handling the event in a derived class. |
| OnHandleMessage(PepperSharp.Var) | Raises the HandleMessage event when the browser calls PostMessage() on the DOM element for the instance in JavaScript.</br></br>**Note**: that PostMessage() in the JavaScript interface is asynchronous, meaning JavaScript execution will not be blocked while OnRecieveMessage is processing the message.</br></br>When converting JavaScript arrays, any object properties whose name is not an array index are ignored.  When passing arrays and objects, the entire reference graph will be converted and transferred.  If the reference graph has cycles, the message will not be sent and an error will be logged to the console.</br></br>**Remarks**: The OnHandleMessage method also enables derived classes to handle the event without attaching a delegate. This is the preferred technique for handling the event in a derived class. |
| BindGraphics(PepperSharp.PPResource) | BindGraphics() binds the given graphics as the current display surface.</br></br>The contents of this device is what will be displayed in the instance's area on the web page. The device must be a 2D or a 3D device.</br></br>You can pass an IsNull (default constructed) Graphics2D as the device parameter to unbind all devices from the given instance. The instance will then appear transparent. Re-binding the same device will return true and will do nothing.</br></br>Any previously-bound device will be released. It is an error to bind a device when it is already bound to another instance. If you want to move a device between instances, first unbind it from the old one, and then rebind it to the new one.</br></br>Binding a device will invalidate that portion of the web page to flush the contents of the new device to the screen. |
| PostMessage(System.Object) | Asynchronously invokes any listeners for message events on the DOM element for the given instance. |
| RequestInputEvents(PepperSharp.PPInputEventClass) | RequestInputEvents() requests that input events corresponding to the given input events are delivered to the instance.</br></br>By default, no input events are delivered.Call this function with the classes of events you are interested in to have them be delivered to the instance. Calling this function will override any previous setting for each specified class of input events(for example, if you previously called RequestFilteringInputEvents(), this function will set those events to non-filtering mode).</br></br>Input events may have high overhead, so you should only request input events that your plugin will actually handle.For example, the browser may do optimizations for scroll or touch events that can be processed substantially faster if it knows there are no non-default receivers for that message. Requesting that such messages be delivered, even if they are processed very quickly, may have a noticeable effect on the performance of the page.</br></br>When requesting input events through this function, the events will be delivered and not bubbled to the page.This means that even if you aren't interested in the message, no other parts of the page will get the message. |
| RequestFilteringInputEvents (PepperSharp.PPInputEventClass) | RequestFilteringInputEvents() requests that input events corresponding to the given input events are delivered to the instance for filtering.</br></br>By default, no input events are delivered.In most cases you would register to receive events by calling RequestInputEvents(). In some cases, however, you may wish to filter events such that they can be bubbled up to the DOM.In this case, register for those classes of events using this function instead of RequestInputEvents(). Keyboard events must always be registered in filtering mode.</br></br>Filtering input events requires significantly more overhead than just delivering them to the instance. As such, you should only request filtering in those cases where it's absolutely necessary. The reason is that it requires the browser to stop and block for the instance to handle the input event, rather than sending the input event asynchronously. This can have significant overhead. |
| ClearInputEventRequest (PepperSharp.PPInputEventClass) | ClearInputEventRequest() requests that input events corresponding to the given input classes no longer be delivered to the instance.</br></br>By default, no input events are delivered.If you have previously requested input events using RequestInputEvents() or RequestFilteringInputEvents(), this function will unregister handling for the given instance.This will allow greater browser performance for those events.</br></br>**Note**: You may still get some input events after clearing the flag if they were dispatched before the request was cleared. For example, if there are 3 mouse move events waiting to be delivered, and you clear the mouse event class during the processing of the first one, you'll still receive the next two. You just won't get more events generated. |
| SetCursor (PepperSharp.PPMouseCursorType, PepperSharp.ImageData, System.Nullable{PepperSharp.PPPoint}) | Sets the given mouse cursor. The mouse cursor will be in effect whenever the mouse is over the given instance until it is set again by another call. Note that you can hide the mouse cursor by setting it to the `MouseCursorType` type.</br></br>This function allows setting both system defined mouse cursors and custom cursors. To set a system-defined cursor, pass the type you want and set the custom image to a default-constructor ImageData object.  To set a custom cursor, set the type to `MouseCursorType.CUSTOM` and specify your image and hot spot. |
| GamepadsSample (PepperSharp.GamepadsSampleData@) | Allows retrieving data from gamepad/joystick devices that are connected to the system. |

## Events

| Event         | Summary                                                                                                 |
| ------------- | ------------------------------------------------------------------------------------------------------- |
| ViewChanged   | Event when the view information for the Instance has changed.  |
| FocusChanged  | Event when an instance has gained or lost focus.  |
| HandleMessage | Event when the browser calls PostMessage() on the DOM element for the instance in JavaScript. |
| InputEvents   | Event when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript. |
| MouseDown  | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a MouseDown InputEvent.  |
| MouseUp | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a MouseUp InputEvent. |
| MouseEnter | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a MouseEnter InputEvent. |
| MouseLeave | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a MouseLeave InputEvent. |
| MouseMove  | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a MouseMove InputEvent. |
| ContextMenu | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a ContextMenu InputEvent. |
| Wheel | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a Wheel InputEvent. |
| KeyUp | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a KeyboardInputEvent for KeyUp. |
| KeyDown | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a KeyboardInputEvent for KeyDown. |
| KeyChar | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a KeyboardInputEvent for Char. |
| RawKeyDown | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a KeyboardInputEvent for RawKeydown. |
| TouchStart | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a TouchInputEvent for TouchStart. |
| TouchEnd | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a TouchInputEvent for TouchEnd. |
| TouchCancel | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a TouchInputEvent for TouchCancel. |
| TouchMove | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a TouchInputEvent for TouchMove. |
| IMECompositionEnd | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a IMEInputEvent for CompositionEnd. |
| IMECompositionStart | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a IMEInputEvent for CompositionStart. |
| IMECompositionUpdate | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a IMEInputEvent for CompositionUpdate. |
| IMEText | Event raised when the browser calls HandleInputEvent on the DOM element for the instance in JavaScript that represents a IMEInputEvent for Text. |

